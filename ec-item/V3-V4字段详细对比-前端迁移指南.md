# V3 vs V4 接口字段详细对比 - 前端迁移指南

> **适用场景**: 前端从原生JS重写为React，同时从V3接口迁移到V4接口
> 
> **文档创建**: 2026-01-28
> 
> **接口路径**: 
> - V3: `GET /items/getItemInfoAllV3`
> - V4: `GET /items/getItemInfoAllV4`

---

## 📊 字段对比总览

| 统计项 | 数量 |
|--------|------|
| V3字段总数 | 13个 |
| V4字段总数 | 24个 |
| 相同字段（取值逻辑一致） | 8个 |
| 相同字段（取值逻辑有变化） | 3个 |
| V4新增字段 | 13个 |
| V4移除字段 | 2个 |

---

## 🔍 完整字段对比表

### 1️⃣ 相同字段 - 取值逻辑完全一致（✅ 无需改动）

这些字段在V3和V4中的**字段名称、数据结构、取值逻辑完全相同**，前端代码可以无缝迁移。

| 字段名 | 数据类型 | 说明 | V3取值 | V4取值 | 前端使用建议 |
|--------|---------|------|--------|--------|-------------|
| **sellerInfo** | Object | 商家信息 | `latchResultMap.get("sellerInfo")` | `latchResultMap.get(SELLER_INFO)` | ✅ 直接使用，无需修改 |
| **brandInfo** | Object | 品牌信息 | `latchResultMap.get("brandInfo")` | `latchResultMap.get(BRAND_INFO)` | ✅ 直接使用，无需修改 |
| **same_day_delivery** | Object | 一日达配送信息 | `setSameDayDeliveryInfo(...)` | `setSameDayDeliveryInfo(...)` | ✅ 直接使用，无需修改 |
| **config** | Object | 配置信息 | `getConfigInfo(...)` | `getConfigInfo(...)` | ✅ 直接使用，无需修改 |
| **currency** | String | 货币符号 | `"Canada"判断 ? "US $" : "$"` | `"Canada"判断 ? "US $" : "$"` | ✅ 直接使用，无需修改 |
| **vipTipInfo** | Object | 会员升级提示 | `getVipTipInfo(...)` | `latchResultMap.get(VIP_TIP_INFO)` | ✅ 直接使用，无需修改（V4改为异步获取，但结构相同） |
| **recommendTabList** | Array/Object | 推荐Tab列表 | `latchResultMap.get(RECOMMEND_TAB_LIST)` | `latchResultMap.get(RECOMMEND_TAB_LIST)` | ✅ 直接使用，无需修改 |
| **googleSeo** | String(JSON) | SEO信息（仅PC） | `requestHandler.getGoogleSeo(...)` | `latchResultMap.get(GOOGLE_SEO)` | ✅ 直接使用，无需修改（V4改为异步获取） |

---

### 2️⃣ 相同字段 - 取值逻辑有变化（⚠️ 需要注意）

这些字段名称相同，但取值逻辑、数据来源或数据结构有所变化，需要前端测试验证。

#### 📌 字段：itemInfo（商品主体信息）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **字段名** | `itemInfo` | `itemInfo` | ✅ 相同 |
| **数据来源** | `getItemInfo(...)` | `getItemInfoMain(...)` | ⚠️ 查询方法不同 |
| **预售处理** | ❌ 无 | ✅ `handlePreSaleProduct(itemInfo, true)` | ⚠️ V4新增预售商品处理 |
| **扩展信息** | ❌ 无 | ✅ `constructItemExtend(itemInfo, tk, reqDTO)` | ⚠️ V4新增扩展信息构造 |
| **paypal字段** | ✅ 有 `itemInfo.paypal = getPayPal(...)` | ❌ 无 | 🔴 **V4中itemInfo不再包含paypal** |
| **字段清理** | ❌ 无 | ✅ `clearNoUseField(itemInfo)` | ⚠️ V4会清除无用字段 |
| **秒杀会员价** | ✅ 秒杀时设置member_price=null | ✅ 秒杀时设置member_price=null | ✅ 逻辑相同 |

**前端迁移建议**:
- ✅ itemInfo的主体结构保持兼容
- 🔴 **重要**: 如果使用了 `itemInfo.paypal` 字段，需要寻找替代方案
- ⚠️ 测试预售商品的展示逻辑
- ⚠️ 检查V4清除的"无用字段"是否有前端在使用

---

#### 📌 字段：gift_list / giftActivityList（赠品活动列表）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **字段名** | `gift_list` | `giftActivityList` | ⚠️ **字段名变化** |
| **数据来源** | `latchResultMap.get("giftActivityList")` | `latchResultMap.get(GIFT_ACTIVITY_LIST)` | ✅ 实际来源相同 |
| **数据结构** | Array | Array | ✅ 相同 |

**前端迁移建议**:
- 🔴 **必须修改**: 字段名从 `gift_list` 改为 `giftActivityList`
- 建议在React组件中定义类型别名，统一使用 `giftList`

```typescript
// 类型定义建议
interface V4Response {
  giftActivityList: GiftActivity[];  // V4使用这个字段名
}

// 使用时可以解构重命名
const { giftActivityList: giftList } = response;
```

---

#### 📌 字段：essayList（专辑列表）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **PC端处理** | 独立字段 `essayList` | 独立字段 `essayList` | ✅ PC端相同 |
| **非PC端处理** | 独立字段 `essayList` | **合并到result主体** | 🔴 **非PC端逻辑完全不同** |
| **数据来源** | `latchResultMap.get("essayList")` | PC: `latchResultMap.get(ESSAY_LIST)`<br>非PC: `snsRequestHandler.queryProductInfoV2(...)` | ⚠️ 非PC端数据结构可能不同 |

**V3代码**:
```java
// V3: 所有平台都返回 essayList 独立字段
result.put("essayList", latchResultMap.get("essayList"));
```

**V4代码**:
```java
// V4: PC端返回独立字段
if (PLATFORM_PC.equals(platform)) {
    result.put(ESSAY_LIST, latchResultMap.get(ESSAY_LIST));
} else {
    // 非PC端：将专辑数据合并到result主体
    try {
        Object res = latchResultMap.get(ESSAY_LIST);
        if (res != null && res instanceof Map) {
            result.putAll((Map) res);  // 直接合并
        }
    } catch (Exception e) {
        log.error("专辑信息强转报错!");
    }
}
```

**前端迁移建议**:
- ✅ **PC端**: 无需修改，继续使用 `response.essayList`
- 🔴 **移动端/H5**: 需要重大调整
  - V3: `response.essayList`
  - V4: 专辑数据被拆散合并到response根级别，需要根据实际字段名读取
  - 建议先在测试环境对比V3和V4的实际返回数据结构

```typescript
// PC端 - 无需修改
const essayList = response.essayList;

// 非PC端 - 需要调整（具体字段名需要测试确认）
// V3: const essayList = response.essayList;
// V4: const essayData = {
//   albums: response.albums,  // 示例，实际字段名需确认
//   collections: response.collections,
//   // ... 其他被拆散的字段
// };
```

---

#### 📌 字段：itemDescList（商品属性列表）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **字段名** | `itemDescList` | `itemDescList` | ✅ 相同 |
| **数据来源** | 同步调用 `itemNBService.getItemProperties(...)` | 异步获取 `latchResultMap.get(ITEM_DESC_LIST)` | ⚠️ V4改为异步 |
| **数据结构** | Array<ItemDesc> | Array<ItemDesc> | ✅ 相同 |

**前端迁移建议**:
- ✅ 字段名和数据结构相同，前端代码无需修改

---

#### 📌 字段：group（商品组信息）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **字段名** | `group` | `group` | ✅ 相同 |
| **存在性判断** | 有判断 `if (null != itemInfo.getGroup())` | 无判断，直接放入 | ⚠️ V4可能返回null |
| **区域限制处理** | ❌ 无 | ✅ 非PC端执行 `filterGroupItemLimit` | 🔴 **V4新增字段** |

**V4新增的商品组字段**（仅非PC端）:
- `is_limit_area`: Boolean - 是否限制区域
- `is_instock`: Integer - 是否有库存
- `status`: String - 商品状态（"A"=可售, "D"=下架）

**前端迁移建议**:
- ✅ 基础group结构保持兼容
- ✅ **非PC端优化**: 可以利用V4新增的 `is_limit_area`, `is_instock`, `status` 字段更精确地展示商品可售状态
- ⚠️ 需要处理 `group` 可能为 `null` 的情况

```typescript
// V3
if (response.group) {
  // 使用商品组信息
}

// V4 - 可以利用新增字段
if (response.group) {
  response.group.groupItemList?.forEach(item => {
    if (item.is_limit_area) {
      // 该商品在当前区域限制销售
    }
    if (!item.is_instock) {
      // 该商品无库存
    }
    if (item.status === 'D') {
      // 该商品已下架
    }
  });
}
```

---

#### 📌 字段：collectionPage（关联商品链接）

| 对比项 | V3 | V4 | 差异说明 |
|--------|----|----|---------|
| **仅PC端** | ✅ 仅PC端返回 | ✅ 仅PC端返回 | ✅ 相同 |
| **数据来源** | 同步调用 `getCollectionPage(...)` | 异步获取 `latchResultMap.get(COLLECTION_PAGE)` | ⚠️ V4改为异步 |
| **数据结构** | List<CollectionPage> | List<CollectionPage> | ✅ 相同 |

**前端迁移建议**:
- ✅ 字段名和数据结构相同，前端代码无需修改

---

### 3️⃣ V4新增字段（✨ 功能增强）

这些字段是V4全新增加的，V3中不存在。前端可以选择性使用这些新功能。

#### 🆕 itemRelateUserData（用户趋势数据）- 核心新增

| 属性 | 详情 |
|------|------|
| **字段名** | `itemRelateUserData` |
| **数据类型** | Object |
| **数据来源** | `pdpItemService.getItemRelateUserData(goodsId, itemNumber, purchaseCount, purchaseAvatorList)` |
| **用途** | 展示商品的用户购买趋势，如"XX人已购买"、用户头像列表等社交证明 |
| **是否必需** | ❌ 可选，用于增强用户信任感 |

**数据结构示例**（需要实际测试确认）:
```typescript
interface ItemRelateUserData {
  purchaseCount?: number;        // 购买人数
  viewCount?: number;            // 浏览人数
  avatarList?: string[];         // 用户头像列表
  // ... 其他可能的字段
}
```

**前端使用建议**:
```typescript
// 展示购买人数
if (response.itemRelateUserData?.purchaseCount) {
  <div>{response.itemRelateUserData.purchaseCount}人已购买</div>
}

// 展示用户头像
if (response.itemRelateUserData?.avatarList?.length > 0) {
  <AvatarGroup avatars={response.itemRelateUserData.avatarList} />
}
```

---

#### 🆕 tabList（Tab展示顺序）

| 属性 | 详情 |
|------|------|
| **字段名** | `tabList` |
| **数据类型** | Array |
| **数据来源** | `handleShowTabList(APP_PDP_TAB_LIST, detail_specification, overview, nfImageList, isShowNI)` |
| **用途** | APP端前三个Tab的展示顺序（商品详情、规格参数、营养成分等） |
| **替代关系** | ✅ **替代V3的need_tabs参数** |
| **是否必需** | ✅ APP端必需 |

**数据结构示例**:
```typescript
interface TabItem {
  id: string;           // tab标识
  name: string;         // tab名称
  order: number;        // 排序
  visible: boolean;     // 是否可见
}

type TabList = TabItem[];
```

**前端使用建议**:
```typescript
// V3: 通过 need_tabs=1 参数控制
// V4: 直接使用返回的 tabList
const tabs = response.tabList || [];
tabs.forEach(tab => {
  if (tab.visible) {
    // 渲染对应的Tab
  }
});
```

---

#### 🆕 nutritionalFacts（营养成分图片列表）

| 属性 | 详情 |
|------|------|
| **字段名** | `nutritionalFacts` |
| **数据类型** | Array<String> |
| **数据来源** | `itemInfo.getNfImageList()` 添加前缀后缀 |
| **用途** | 营养成分表图片URL列表 |
| **显示条件** | 配置开关 `PDP_NI_SHOW === "YES"` |
| **是否必需** | ❌ 可选 |

**URL格式**:
```java
NF_IMAGE_PREFIX + imageId + NF_IMAGE_SUFFIX
```

**前端使用建议**:
```typescript
if (response.nutritionalFacts?.length > 0) {
  <ImageGallery images={response.nutritionalFacts} title="营养成分" />
}
```

---

#### 🆕 psCode（促销优惠券码）

| 属性 | 详情 |
|------|------|
| **字段名** | `psCode` |
| **数据类型** | String | null |
| **数据来源** | `couponInfo.getCouponCode()` |
| **用途** | 可复制的优惠券码 |
| **取值逻辑** | 有优惠券时返回码，无优惠券时为null |
| **是否必需** | ❌ 可选 |

---

#### 🆕 couponCodeDesc（优惠券描述）

| 属性 | 详情 |
|------|------|
| **字段名** | `couponCodeDesc` |
| **数据类型** | String |
| **数据来源** | 优惠券信息或促销语 |
| **用途** | 展示给用户的促销文案 |
| **是否必需** | ✅ 建议使用（替代直接使用promotion_desc） |

**取值逻辑**:
```java
if (couponInfo为空 || couponCode为空) {
    couponCodeDesc = itemInfo.getPromotion_desc();  // 使用促销语
} else {
    // 如果促销语为空，用优惠券文案兜底
    couponCodeDesc = StringUtils.isEmpty(itemInfo.getPromotion_desc()) 
        ? couponInfo.getCouponName() + ", " + "优惠码" + ": " + psCode 
        : itemInfo.getPromotion_desc();
}
```

**前端使用建议**:
```typescript
// V3: 直接使用 itemInfo.promotion_desc
// V4: 优先使用 couponCodeDesc（更智能的促销文案）
const promotionText = response.couponCodeDesc || response.itemInfo?.promotion_desc;

// 如果有优惠券码，可以添加复制功能
if (response.psCode) {
  <PromotionBanner 
    text={promotionText}
    couponCode={response.psCode}
    onCopy={() => copyToClipboard(response.psCode)}
  />
}
```

---

#### 🆕 badgeList（商品徽章列表）

| 属性 | 详情 |
|------|------|
| **字段名** | `badgeList` |
| **数据类型** | Array |
| **数据来源** | `pdpItemService.getItemBadgeList(yLanguage, token, itemNumber)` |
| **用途** | 商品徽章标签，如"新品"、"热卖"、"限时"等 |
| **是否必需** | ❌ 可选 |

**前端使用建议**:
```typescript
if (response.badgeList?.length > 0) {
  <BadgeGroup badges={response.badgeList} />
}
```

---

#### 🆕 itemTags（商品标签）

| 属性 | 详情 |
|------|------|
| **字段名** | `itemTags` |
| **数据类型** | Array<Map<String, Object>> |
| **数据来源** | `getItemTags(itemInfo, yLanguage)` |
| **用途** | 商品标签信息 |
| **是否必需** | ❌ 可选 |

---

#### 🆕 purchaseProtection（购物保障）- 仅non用户

| 属性 | 详情 |
|------|------|
| **字段名** | `purchaseProtection` |
| **数据类型** | Object |
| **数据来源** | `getPurchaseProtection(token, yLanguage, platform)` |
| **显示条件** | 仅对non用户（未登录/新用户）显示 |
| **用途** | 展示购物保障信息，增强用户信任 |
| **是否必需** | ❌ 可选 |

---

#### 🆕 topImage（顶部图片）- 仅non用户

| 属性 | 详情 |
|------|------|
| **字段名** | `topImage` |
| **数据类型** | String (URL) |
| **数据来源** | 配置 `PDP_TOP_IMAGES` 根据语言返回 |
| **显示条件** | 仅对non用户显示 |
| **用途** | 商品详情页顶部banner图 |
| **是否必需** | ❌ 可选 |

---

#### 🆕 topImageBackgroundColor（顶部图片背景色）- 仅non用户

| 属性 | 详情 |
|------|------|
| **字段名** | `topImageBackgroundColor` |
| **数据类型** | String (颜色值) |
| **数据来源** | 常量 `BACKGROUND_COLOR` |
| **显示条件** | 仅对non用户显示（且有topImage时） |
| **用途** | 顶部图片的背景色 |
| **是否必需** | ❌ 可选 |

**前端使用建议**:
```typescript
// non用户特殊展示
const isNonUser = response.userType === 'U1';
if (isNonUser && response.topImage) {
  <TopBanner 
    imageUrl={response.topImage}
    backgroundColor={response.topImageBackgroundColor}
  />
}
```

---

#### 🆕 userType（用户类型）

| 属性 | 详情 |
|------|------|
| **字段名** | `userType` |
| **数据类型** | String (Enum) |
| **可能值** | `U1`(non用户), `U2`(普通用户), `U3`(会员) 等 |
| **数据来源** | `customerRequestHandler.getUserGroup(token)` |
| **用途** | 区分用户类型，进行差异化展示 |
| **是否必需** | ✅ 建议使用（用于判断是否展示non用户专属内容） |

**前端使用建议**:
```typescript
const isNonUser = response.userType === 'U1';
const isVipUser = response.userType === 'U3';

// 根据用户类型差异化展示
if (isNonUser) {
  // 展示 purchaseProtection, topImage 等non用户专属内容
}
if (isVipUser) {
  // 展示会员专属内容
}
```

---

### 4️⃣ V4移除字段（❌ 需要替代方案）

这些字段在V3中存在，但V4中已移除。

#### ❌ paypal（PayPal支付信息）

| 属性 | 详情 |
|------|------|
| **V3位置** | `itemInfo.paypal` |
| **V4状态** | ❌ 完全移除 |
| **影响范围** | 如果前端页面有PayPal支付相关展示或逻辑 |
| **替代方案** | 需要与后端确认：<br>1. PayPal功能是否废弃？<br>2. 是否有新的字段替代？<br>3. 是否需要单独接口获取？ |

**前端迁移建议**:
```typescript
// V3
if (response.itemInfo.paypal) {
  // 展示PayPal支付按钮
  <PayPalButton config={response.itemInfo.paypal} />
}

// V4
// 🔴 需要确认替代方案！
// 方案1: 如果PayPal功能废弃，移除相关代码
// 方案2: 如果有新字段，使用新字段
// 方案3: 如果需要单独接口，调用新接口获取
```

---

#### ❌ need_tabs参数对应的特殊处理

| 属性 | 详情 |
|------|------|
| **V3处理** | `need_tabs=1` 时，返回 `recommendTabList` |
| **V4状态** | 参数移除，但 `tabList` 字段默认返回 |
| **替代方案** | ✅ 使用V4的 `tabList` 字段 |

---

## 🔄 数据获取方式变化总览

### V3的数据获取流程
```
1. 同步查询商品信息 getItemInfo()
2. 同步查询商品属性 getItemProperties()
3. 启动4个线程并行查询:
   - Thread 1: 商家信息
   - Thread 2: 品牌信息
   - Thread 3: 专辑列表
   - Thread 4: 赠品列表 + (条件)推荐Tab
4. 组装返回数据
5. 执行 filterSoldOut 后处理
```

### V4的数据获取流程
```
1. 同步查询商品信息 getItemInfoMain()
2. 预售商品处理 handlePreSaleProduct()
3. 构造商品扩展信息 constructItemExtend()
4. 启动7个批处理任务并行查询:
   - Task 1: 商家信息
   - Task 2: 品牌信息 + 用户类型 + (条件)购物保障/推荐Tab/顶部图片 + 商品组
   - Task 3: 专辑信息 + 优惠券信息
   - Task 4: 用户趋势数据 + 商品徽章
   - Task 5: 赠品列表 + 商品属性
   - Task 6: 商品标签 + 会员信息
   - Task 7: (仅PC) SEO + Collection信息
5. 组装返回数据
6. 执行 afterHandle 后处理:
   - filterSoldOut
   - (非PC端) filterGroupItemLimit
7. 清除无用字段 clearNoUseField()
```

**性能影响**: V4通过批处理任务优化，理论上性能应该更好或相当。

---

## 📋 前端迁移Checklist

### 阶段一：代码审查

- [ ] **检查PayPal依赖**
  - [ ] 搜索代码中所有使用 `paypal` 的地方
  - [ ] 确认是否需要PayPal功能
  - [ ] 与后端确认替代方案

- [ ] **检查need_tabs使用**
  - [ ] 搜索代码中所有使用 `need_tabs` 参数的地方
  - [ ] 确认是否可以用 `tabList` 字段替代

- [ ] **检查essayList使用**
  - [ ] 区分PC端和移动端的使用场景
  - [ ] 确认移动端是否使用了专辑功能
  - [ ] 在测试环境对比V4非PC端的实际返回结构

- [ ] **检查字段名变化**
  - [ ] `gift_list` → `giftActivityList`
  - [ ] 更新TypeScript类型定义

### 阶段二：类型定义

创建完整的TypeScript类型定义：

```typescript
// V4接口返回类型
interface GetItemInfoAllV4Response {
  // 基础信息（兼容V3）
  itemInfo: ItemInfo;
  sellerInfo: SellerInfo;
  brandInfo: BrandInfo;
  giftActivityList: GiftActivity[];     // V3是gift_list
  itemDescList: ItemDesc[];
  same_day_delivery: SameDayDelivery;
  group?: Group;
  config: Config;
  currency: string;
  vipTipInfo: VipTipInfo;
  recommendTabList?: RecommendTab[];
  
  // V4新增字段
  itemRelateUserData?: ItemRelateUserData;  // 核心新增
  tabList?: TabItem[];                       // 替代need_tabs
  nutritionalFacts?: string[];
  psCode?: string;
  couponCodeDesc?: string;
  badgeList?: Badge[];
  itemTags?: ItemTag[];
  
  // non用户专属（条件返回）
  purchaseProtection?: PurchaseProtection;
  topImage?: string;
  topImageBackgroundColor?: string;
  userType?: 'U1' | 'U2' | 'U3';  // U1=non, U2=普通, U3=会员
  
  // PC端专属
  essayList?: Essay[];                       // PC端是独立字段
  collectionPage?: CollectionPage[];
  googleSeo?: string;  // JSON字符串
  
  // 注意：V3的以下字段在V4中移除
  // - itemInfo.paypal (已移除)
  // - essayList在非PC端被拆散合并到根级别
}

// 商品组新增字段
interface GroupItem {
  // ... 原有字段
  is_limit_area?: boolean;  // V4新增：是否限制区域
  is_instock?: number;       // V4新增：库存状态
  status?: 'A' | 'D';        // V4新增：A=可售，D=下架
}
```

### 阶段三：适配层开发

建议开发一个适配层，处理V3到V4的数据转换：

```typescript
// adapter.ts
export function adaptV4Response(v4Response: any) {
  return {
    ...v4Response,
    // 字段名适配
    giftList: v4Response.giftActivityList,
    
    // 移动端essayList适配（如果需要）
    essayList: v4Response.essayList || extractEssayFromRoot(v4Response),
    
    // PayPal适配（根据实际情况）
    paypal: null,  // 或从其他地方获取
  };
}

function extractEssayFromRoot(response: any) {
  // 从response根级别提取专辑相关字段
  // 具体逻辑需要根据实际返回数据确定
  return null;
}
```

### 阶段四：测试验证

- [ ] **单元测试**
  - [ ] 测试适配层逻辑
  - [ ] 测试字段映射正确性
  - [ ] 测试空值处理

- [ ] **集成测试**
  - [ ] PC端页面测试
  - [ ] 移动端/H5页面测试
  - [ ] 普通商品测试
  - [ ] 商品组商品测试
  - [ ] 有促销/无促销商品
  - [ ] 有优惠券/无优惠券商品
  - [ ] 预售商品测试
  - [ ] 不同区域的商品可售状态

- [ ] **性能测试**
  - [ ] 对比V3和V4的响应时间
  - [ ] 检查是否有性能退化

### 阶段五：新功能集成（可选）

- [ ] **用户趋势数据**
  - [ ] 设计UI组件展示购买人数
  - [ ] 设计UI组件展示用户头像
  
- [ ] **营养成分**
  - [ ] 设计营养成分展示组件
  
- [ ] **商品徽章**
  - [ ] 设计徽章展示组件
  
- [ ] **优惠券优化**
  - [ ] 添加优惠券码复制功能
  - [ ] 优化促销文案展示

- [ ] **non用户体验优化**
  - [ ] 根据userType展示差异化内容
  - [ ] 添加购物保障模块
  - [ ] 添加顶部banner

---

## ⚠️ 重点注意事项

### 1. PayPal功能确认（🔴 高优先级）
**必须与后端确认**：
- PayPal功能是否彻底废弃？
- 如果没废弃，新的获取方式是什么？
- 前端是否需要移除所有PayPal相关代码？

### 2. 非PC端essayList处理（🔴 高优先级）
**必须在测试环境验证**：
- V4非PC端的专辑数据结构是什么样的？
- 哪些字段被合并到了根级别？
- 前端需要如何调整数据读取逻辑？

### 3. 商品组区域限制（🟡 中优先级）
**建议利用新功能**：
- V4非PC端的商品组包含区域限制信息
- 可以更精确地展示商品可售状态
- 改善用户体验

### 4. 优惠券展示优化（🟡 中优先级）
**建议使用新字段**：
- 优先使用 `couponCodeDesc` 而非 `itemInfo.promotion_desc`
- V4的促销文案逻辑更智能
- 如果有 `psCode`，添加复制功能

### 5. 用户类型差异化（🟢 低优先级）
**可选功能增强**：
- 利用 `userType` 字段进行差异化展示
- non用户展示更多信任相关内容
- 会员用户展示会员专属内容

---

## 📞 问题反馈

如在迁移过程中遇到以下问题，请及时反馈：

1. **V4缺少V3的某个必需字段** → 与后端确认是否遗漏
2. **V4字段数据结构与预期不符** → 提供实际数据样例
3. **V4接口性能明显下降** → 提供性能对比数据
4. **V4接口返回错误或异常** → 提供错误日志
5. **业务逻辑不清楚** → 与产品/后端确认需求

---

**文档更新时间**: 2026-01-28  
**文档维护**: 如发现新的差异点或问题，请及时更新本文档
